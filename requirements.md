# Square
## 概要
静的ページで表示され、ブラウザ上で遊べる縦長の落ちモノパズルゲームです。

## 仕様

- 落ちモノパズル
- 横 8マス、縦 20マス（仮）
- ブロックの色は3色（青赤黄）
- ブロックが下まで落ちた時に同じ色で４マス以上の四角形（スクエア）になると消える
- 消えるパターン
    - 2x2
    - 2x3
    - 3x3
- ブロックが消えた場合、上にあるブロックは落下する（自由落下）
- 消えたマス分得点となる
- 落ちてくるブロック
    - 2x2マスのみ
    - パターンは4, 3x1, 2x2, 2x1x1
    - 左右キーで落ちる位置を変えられる
        - 連続入力待ち 4フレーム
    - 30フレームで１つ下に落ちる
    - 落ちるタイミングでそれ以上下に行けない場合、止まる
    - 止まった後に消える判定
    - 消えた後、自由落下処理
    - 自由落下処理後、次のブロックの落下開始
- フレームレートは30fps

## 落下ブロックのパターン詳細

落下ブロックは2x2マスで構成され、以下の4パターンがあります：

1. **パターン4（全て同色）**
   ```
   ■■
   ■■
   ```
   4つ全て同じ色

2. **パターン3x1（3つ同色+1つ別色）**
   ```
   ■■
   ■□
   ```
   3つが同じ色、1つが異なる色（配置はランダム）

3. **パターン2x2（2つずつ同じ色）**
   ```
   ■□  または  ■■
   □■          □□
   ```
   横並び、または斜め配置

4. **パターン2x1x1（2つ同色+1つずつ異なる色）**
   ```
   ■■
   □△
   ```
   2つが同じ色、残り2つが異なる色

## 消去ルール詳細

- 同じ色で4マス以上の四角形（矩形）が形成されると消える
- 消えるサイズ：2x2, 2x3, 3x2, 3x3, 2x4, 4x2, 3x4, 4x3, 4x4など全ての矩形
- 複数の四角形が同時に形成された場合、全て消える
- 連鎖（消去後の落下で再度消去）は発生するが、ボーナス得点はなし
- 得点は消えたマス数の合計

## ゲームオーバー条件

- ブロックが止まった後、消去可能なブロックがない状態で、一番上の段（Y座標0）にブロックが存在する場合
- ゲームオーバー時は「GAME OVER」表示とリスタートボタンを表示

## 操作方法

- **左右キー**：ブロックの横移動（連続入力待ち4フレーム）
- **上キー or Zキー**：右回転（90度時計回り）
- **下キー**：高速落下（5フレームで1マス下に落ちる）
- **スペースキー**：即座落下（一瞬で接地位置まで落下）
- **Pキー**：一時停止/再開
- **Rキー**：リスタート

## UI要素

- **ゲームフィールド**：8x20マスのグリッド（Canvas）
- **スコア表示**：現在のスコア
- **ネクストブロック**：次に落ちてくるブロックのプレビュー
- **一時停止ボタン**：クリックで一時停止
- **リスタートボタン**：クリックでゲームをリセット

## 技術スタック

- **HTML5 Canvas API**：ゲーム描画
- **Vanilla JavaScript**：ゲームロジック
- **HTML/CSS**：UI要素（スコア表示、ボタンなど）
- 外部ライブラリ依存なし

## デザイン仕様

- **ブロックの色**
  - 青：`#3498db`
  - 赤：`#e74c3c`
  - 黄：`#f1c40f`
- **背景色**：`#2c3e50`（フィールド）
- **グリッド線**：`#34495e`
- **ブロックサイズ**：30px × 30px（仮）
